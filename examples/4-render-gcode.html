<!DOCTYPE html>
<html lang="en">
<head>
	<title>4-render-gcode</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>

<body>


<div id="show_div">
	<label> show </label> <br/>
	<input id="show" type="range" min="1" max="100" defaultValue="1" step="1" oninput="oninput_show()"/> <label id="show_index">  </label> <br/>
</div>

<label> WALL_INNER </label> <input id="cb_WALL_INNER" type="checkbox" checked="true" onchange="onchange_type_WALL_INNER()"/>
<label> WALL_OUTER </label> <input id="cb_WALL_OUTER" type="checkbox" checked="true" onchange="onchange_type_WALL_OUTER()"/>
<label> SKIN </label> <input id="cb_SKIN" type="checkbox" checked="true" onchange="onchange_type_SKIN()"/>
<label> SKIRT </label> <input id="cb_SKIRT" type="checkbox" checked="true" onchange="onchange_type_SKIRT()"/>
<label> SUPPORT </label> <input id="cb_SUPPORT" type="checkbox" checked="true" onchange="onchange_type_SUPPORT()"/>
<label> FILL </label> <input id="cb_FILL" type="checkbox" checked="true" onchange="onchange_type_FILL()"/>
<label> UNKNOWN </label> <input id="cb_UNKNOWN" type="checkbox" checked="true" onchange="onchange_type_UNKNOWN()"/>

<div id="WebGL-output">
</div>

<script src="../build/three.js"></script>
<script src="js/controls/OrbitControls.js"></script>
<script src="js/loaders/GCodeLoader2.js"></script>

<script>

    var camera, scene, renderer;
    var gcodeLoader2 = new THREE.GCodeLoader2();

    init();
    animate();

    addOrbitControls();

    function addOrbitControls() {
        var controls = new THREE.OrbitControls(camera, renderer.domElement);
        //tip : must call 'render()' rather than 'animate()', or UI lags
        controls.addEventListener('change', render);
    }

    function render() {
        renderer.render( scene, camera );
    }

    function init() {
        scene = new THREE.Scene();

        camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.x = 0;
        camera.position.y = 0;
        camera.position.z = 120;
        camera.lookAt(new THREE.Vector3(0, 0, 0));

        webGLRenderer = new THREE.WebGLRenderer( { antialias: true } );
        webGLRenderer.setClearColor(new THREE.Color(0xE8E8E8), 1.0);
        webGLRenderer.setSize(window.innerWidth, window.innerHeight);
        webGLRenderer.shadowMapEnabled = true;

        var path =  'models/gcode/benchy.gcode';
        gcodeLoader2.load( path, function ( object ) {

            object.position.set( -100, -20, 100 );
            scene.add( object );

            document.getElementById("show").max = gcodeLoader2.layerCount;

        });

        renderer = new THREE.WebGLRenderer();
        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize( window.innerWidth, window.innerHeight );

        window.addEventListener( 'resize', resize, false );

        document.getElementById("WebGL-output").appendChild( renderer.domElement );

    }

    function resize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

    }

    function animate() {

        renderer.render( scene, camera );

        requestAnimationFrame( animate );

    }

    function oninput_show() {

        var value = document.getElementById("show").value;
        document.getElementById("show_index").innerHTML = value +"";

        gcodeLoader2.showLayers( value );
    }

    function onchange_type_WALL_INNER() {

        if( document.getElementById("cb_WALL_INNER").checked == true ){
            gcodeLoader2.showType( 'WALL-INNER' );
		}else {
            gcodeLoader2.hideType( 'WALL-INNER' );
		}

    }

    function onchange_type_WALL_OUTER() {

        if( document.getElementById("cb_WALL_OUTER").checked == true ){
            gcodeLoader2.showType( 'WALL-OUTER' );
        }else {
            gcodeLoader2.hideType( 'WALL-OUTER' );
        }

    }

    function onchange_type_SKIN() {
        if( document.getElementById("cb_SKIN").checked == true ){
            gcodeLoader2.showType( 'SKIN' );
        }else {
            gcodeLoader2.hideType( 'SKIN' );
        }

    }

    function onchange_type_SKIRT() {
        if( document.getElementById("cb_SKIRT").checked == true ){
            gcodeLoader2.showType( 'SKIRT' );
        }else {
            gcodeLoader2.hideType( 'SKIRT' );
        }

    }

    function onchange_type_SUPPORT() {

        if( document.getElementById("cb_SUPPORT").checked == true ){
            gcodeLoader2.showType( 'SUPPORT' );
        }else {
            gcodeLoader2.hideType( 'SUPPORT' );
        }
    }

    function onchange_type_FILL() {

        if( document.getElementById("cb_FILL").checked == true ){
            gcodeLoader2.showType( 'FILL' );
        }else {
            gcodeLoader2.hideType( 'FILL' );
        }
    }

    function onchange_type_UNKNOWN() {
        if( document.getElementById("cb_UNKNOWN").checked == true ){
            gcodeLoader2.showType( 'UNKNOWN' );
        }else {
            gcodeLoader2.hideType( 'UNKNOWN' );
        }

    }

</script>

</body>
</html>
